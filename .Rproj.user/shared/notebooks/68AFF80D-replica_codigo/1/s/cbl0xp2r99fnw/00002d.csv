"0",""
"0","# return the data frame to the scenario including the intervention"
"0","datanew <- data.frame(stdpop=mean(data$stdpop),smokban=rep(c(0,1),c(360,240)),"
"0","  time= 1:600/10,month=rep(1:120/10,5))"
"0",""
"0",""
"0","################################################################################"
"0","#Step 5: methodological issues"
"0","##################################################################"
"0",""
"0","#a) Overdispersion: Quasi-Poisson model "
"0","# In the model above we have not allowed for overdispersion - in order to do"
"0","#   this we can use a quasipoisson model, which allows the variance to be"
"0","#   proportional rather than equal to the mean"
"0",""
"0","model2 <- glm(aces ~ offset(log(stdpop)) + smokban + time, family=quasipoisson,"
"0","  data)"
"0","summary(model2)"
"1","
Call:
"
"1",""
"1","glm(formula = aces ~ offset(log(stdpop)) + smokban + time, family = quasipoisson, 
    data = data)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1","  t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -6.2431509"
"1","  0.0211096"
"1"," -295.749"
"1","  < 2e-16"
"1"," ***"
"1","
smokban    "
"1"," -0.1116284"
"1","  0.0324959"
"1","   -3.435"
"1","  0.00112"
"1"," ** "
"1","
time       "
"1","  0.0049450"
"1","  0.0009418"
"1","    5.250"
"1"," 2.43e-06"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","quasipoisson"
"1",""
"1"," family taken to be "
"1",""
"1","3.559195"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 308.52  on 58  degrees of freedom
"
"1",""
"1","Residual deviance: 197.31  on 56  degrees of freedom
"
"1","AIC: "
"1",""
"1","NA"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","3"
"1",""
"1","
"
"1","
"
"0","summary(model2)$dispersion"
"1","[1]"
"1"," 3.559195"
"1","
"
"0","round(ci.lin(model2,Exp=T),3)"
"1","           "
"1"," Estimate"
"1"," StdErr"
"1","        z"
"1","     P"
"1"," exp(Est.)"
"1","  2.5%"
"1"," 97.5%"
"1","
(Intercept)"
"1","   -6.243"
"1","  0.021"
"1"," -295.749"
"1"," 0.000"
"1","     0.002"
"1"," 0.002"
"1"," 0.002"
"1","
smokban    "
"1","   -0.112"
"1","  0.032"
"1","   -3.435"
"1"," 0.001"
"1","     0.894"
"1"," 0.839"
"1"," 0.953"
"1","
time       "
"1","    0.005"
"1","  0.001"
"1","    5.250"
"1"," 0.000"
"1","     1.005"
"1"," 1.003"
"1"," 1.007"
"1","
"
"0","#b) Model checking and autocorrelation"
"0",""
"0","# Check the residuals by plotting against time"
"0","res2 <- residuals(model2,type=""deviance"")"
"0","plot(data$time,res2,ylim=c(-5,10),pch=19,cex=0.7,col=grey(0.6),"
"0","  main=""Residuals over time"",ylab=""Deviance residuals"",xlab=""Date"")"
